# cython: language_level=3


import unittest
import requests
from src.utils.specifics.specific import format_url
from src.vulnerability.cve.joomla.CVE_2023_23752.joomla_db_exploit import (
    JoomlaCveDBUnder428,
)

# Requirments : http://localhost/joomla_427 need to be an Joomla Website with versions (4.0.0 <= Joomla <= 4.2.7).


class TestJommlaDbXploit(unittest.TestCase):
    def test_with_url_not_vulnerable(self):
        session = requests.Session()
        self.assertEqual(
            JoomlaCveDBUnder428().run("http://localhost/anithing", session), False
        )

    def test_with_url_vulnerable(self):
        session = requests.Session()
        self.assertEqual(
            JoomlaCveDBUnder428().run("http://localhost/wxplt/joomla_427", session),
            True,
        )


if __name__ == "__main__":
    unittest.main()
