# cython: language_level=3


import unittest
import requests
from src.vulnerability.disclosure.git.git_path import ExploitGitVuln


class TestEnvPath(unittest.TestCase):
    def test_with_valid_git(self):
        sessions = requests.Session()
        self.assertEqual(
            ExploitGitVuln().run("http://localhost/wxplt/git/dumping/", sessions), True
        )

    def test_with_invalid_git(self):
        sessions = requests.Session()
        self.assertEqual(
            ExploitGitVuln().run(
                "http://localhost/wxplt/git/dumping/invalide", sessions
            ),
            False,
        )


if __name__ == "__main__":
    unittest.main()
