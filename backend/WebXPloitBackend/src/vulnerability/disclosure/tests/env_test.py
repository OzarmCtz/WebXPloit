# cython: language_level=3


import unittest
import requests
from src.vulnerability.disclosure.env.env_path import ExploitEnvVuln


class TestEnvPath(unittest.TestCase):
    def test_with_valid_env_with_db(self):
        sessions = requests.Session()
        self.assertEqual(
            ExploitEnvVuln().run("http://localhost/wxplt/env/valide", sessions), True
        )

    def test_with_invalid_env(self):
        sessions = requests.Session()
        self.assertEqual(
            ExploitEnvVuln().run("http://localhost/wxplt/env/invalide", sessions), False
        )


if __name__ == "__main__":
    unittest.main()
