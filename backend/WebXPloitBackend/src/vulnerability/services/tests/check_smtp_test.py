# cython: language_level=3


import unittest


from src.vulnerability.services.check_smtp import ProcessSmtp


# Requirments : keep sur test_with_valide_smtp have a smtp working
class TestConnectSMTP(unittest.TestCase):
    def test_with_valide_smtp(self):
        self.assertEqual(
            ProcessSmtp().run(
                "smtp.office365.com", "587", "emision@unityseguros.com", "0DIbQyRE0JG*"
            ),
            True,
        )

    def test_with_invalide_smtp(self):
        self.assertEqual(
            ProcessSmtp().run(
                "smtp.office365.com",
                "587",
                "emision@unityseguros.comFALSE",
                "0DIbQyRE0JG*",
            ),
            False,
        )


if __name__ == "__main__":
    unittest.main()
