# cython: language_level=3


import unittest


from src.vulnerability.services.check_database import ProcessDatabase


# Requirments : Mysql 127.0.0.1 Open with wxplt db with 2 tables.


class TestConnectDB(unittest.TestCase):
    def test_with_valide_db(self):
        self.assertEqual(
            ProcessDatabase().connect_to_mysql(
                "127.0.0.1", "root", "", "wxplt", "3306"
            ),
            True,
        )

    def test_with_invalide_db(self):
        self.assertEqual(
            ProcessDatabase().connect_to_mysql(
                "150.158.55.37", "root_invalide", "ysj1234", "pkt", "3306"
            ),
            False,
        )


if __name__ == "__main__":
    unittest.main()
